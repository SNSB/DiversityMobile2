{"version":3,"file":"index.js","sourceRoot":"","sources":["index.tsx"],"names":["DiversityMobile2","DiversityMobile2.Application","DiversityMobile2.Application.initialize","DiversityMobile2.Application.onLoginClick","DiversityMobile2.Application.onLogin","DiversityMobile2.Application.onDeviceReady","DiversityMobile2.Application.onPause","DiversityMobile2.Application.onResume"],"mappings":"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","sourcesContent":["// For an introduction to the Blank template, see the following documentation:\r\n// http://go.microsoft.com/fwlink/?LinkID=397705\r\n// To debug code on page load in Ripple or on Android devices/emulators: launch your app, set breakpoints, \r\n// and then run \"window.location.reload()\" in the JavaScript Console.\r\n\r\n/// <reference path=\"typings/cordova/plugins/InAppBrowser.d.ts\"/>\r\n\r\n\r\nimport React = require('react');\r\nimport ReactDOM = require('react-dom');\r\nimport hello = require('hellojs'); \r\nimport rest = require('rest');\r\nimport mime = require('rest/interceptor/mime');\r\nimport interceptor = require('rest/interceptor');\r\n\r\nmodule DiversityMobile2 {\r\n    \"use strict\";\r\n    var api_server = \"https://diversityapi.azurewebsites.net\"\r\n    var api_base = api_server + \"/api\";\r\n    var ext_logins = api_base + \"/account/ExternalLogins?returnUrl=%2F&generateState=true\";\r\n\r\n    var correlationState = {\r\n        cookieName: \".AspNet.Correlation.\",\r\n        cookieValue: \"\"\r\n    };\r\n    var correlationInterceptor = interceptor({\r\n        response: function (response, config, meta) {\r\n            var set_cookies = response.headers[\"Set-Cookie\"];\r\n            if (set_cookies) {\r\n                // if only a single header, wrap it in an array\r\n                if (typeof (set_cookies) === 'string') {\r\n                    set_cookies = [set_cookies];\r\n                }\r\n                for (var i = 0; i < set_cookies.length; i++) {\r\n                    var cookie = set_cookies[i];\r\n                    var nv = cookie.split('=');\r\n                    var name = nv[0];\r\n                    if (name === correlationState.cookieName) {\r\n                        correlationState.cookieValue = cookie;\r\n                    }\r\n                }\r\n            }\r\n            return response;\r\n        },\r\n        request: function (request, config, meta) {\r\n            if (correlationState.cookieValue) {\r\n                var cookies = request.headers[\"Cookie\"];\r\n                if (cookies !== \"\") {\r\n                    cookies += \"; \";\r\n                }\r\n                cookies += correlationState.cookieValue;\r\n\r\n                request.headers[\"Cookie\"] = cookies;\r\n            }\r\n            return request;\r\n        }\r\n    });\r\n\r\n    export module Application {\r\n        export function initialize() {\r\n            document.addEventListener('deviceready', onDeviceReady, false);  \r\n        }\r\n  \r\n        function onLoginClick() {\r\n            //hello('windows').login();\r\n            var client = rest\r\n                .wrap(mime);\r\n\r\n            client(ext_logins).then(function (response) {\r\n                var entity = response.entity[0];\r\n                var uri = api_server + entity.Url;\r\n\r\n                var browser = window.open(uri);\r\n\r\n                browser.addEventListener(\"loadstart\", (event) => {\r\n                    console.log(event);\r\n                });\r\n            });\r\n        } \r\n\r\n        function onLogin(auth: HelloJSEventArgument) {\r\n            // Call user information, for the given network\r\n            hello(auth.network).api('/me').then(function (r) {\r\n                // Inject it into the container\r\n                var label = document.getElementById('profile_' + auth.network);\r\n                if (!label) {\r\n                    label = document.createElement('div');\r\n                    label.id = 'profile_' + auth.network;\r\n                    document.getElementById('profile').appendChild(label);\r\n                }\r\n                label.innerHTML = '<img src=\"' + r.thumbnail + '\" /> Hey ' + r.name;\r\n            });\r\n\r\n            var session = hello(auth.network).getAuthResponse();\r\n\r\n            \r\n        }\r\n\r\n        function onDeviceReady() {\r\n            // Handle the Cordova pause and resume events \r\n            document.addEventListener('pause', onPause, false);\r\n            document.addEventListener('resume', onResume, false); \r\n\r\n            hello.init({\r\n                windows: '000000004C0FE46A'\r\n            }, { redirect_uri: 'https://diversityapi.azurewebsites.net/redirect.html' });\r\n\r\n            hello.on('auth.login', onLogin);\r\n            \r\n            // TODO: Cordova has been loaded. Perform any initialization that requires Cordova here.\r\n\r\n            var button = ReactDOM.render(\r\n                <button onClick={onLoginClick} > Windows Hello</button>,\r\n                document.getElementById('example') \r\n            );\r\n        }\r\n\r\n        function onPause() {\r\n            // TODO: This application has been suspended. Save application state here.\r\n        }\r\n\r\n        function onResume() {\r\n            // TODO: This application has been reactivated. Restore application state here.\r\n        }\r\n\r\n    }\r\n\r\n    window.onload = function () {\r\n        Application.initialize();\r\n    }\r\n}\r\n"]}